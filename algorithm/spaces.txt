class Space:
    attributes:
        rect, cards

    create space(position)
        set rect at position
        set cards to []

    is_empty:
        return if length of space.cards is 0

    @property
    card:
        if not empty:
            return last card in self.cards

    add_card(card):
        card.set_base(self)
        self.cards.append(card)

    check_for_target(cursor location):
        if cursor in rect and cards not empty:
            return space.card


    draw(screen):
        draw rectangle
        if not empty:
            space.card.draw 

    get_valid_dest(card):
        return space.isempty and space intersects card

    remove_card(card):
        remove card from self.cards if card is there.


class Foundation(space):

    draw(screen):
        for card in cards, starting from end:
            if card isn't held:
                card.draw(screen)
                return
        draw rectangle

    get_valid_dest(card):
        if card isn't stacked and card.piles_up(self.card) and rects intersect:
            return self
   

class FreeCell(space):

    get_valid_dest(card):
        if card isn't stacked:
            return super().get_valid_dest(card)

class StackSpace(space):
    attributes:
        parent_card, cards, rect

    create_space(card):
        set parent_card to card variable
        position is parent_card's topleft offset by the stack offset
        Space.__init__(position)

    def get_valid_dest(card):
        if space intersects card and card.stacks_down(self.parent_card)
            return self

    def move(location):
        set rect to new location
        if card in space, move card along with space.



class Tableau(Space):

    @property
    top_card:
        set highest_card to self.card
        if highest_card:
            while highest_card has card above it:
                set highest_card to above card
            return highest card

    @property
    top_space:
        if top_card:
            return top_card.space
        else:
            return else
    
    check_for_target:
        if cursor x within tableau x:
            target_card = self.top_card
            while target card:
                if cursor within card rect:
                    return card
                else:
                    target card = card.below_card

    get_valid_dest(card):
        if self.card:
            return top_space.valid_dest(card)
        else:
            return super().get_valid_Dest(card)

    stack_card(card):
        self.top_space.add_card(card)
    
